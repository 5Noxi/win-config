{
  "Disable Device Powersavings": {
    "apply": {
      "HKLM\\SYSTEM\\CurrentControlSet\\Services\\usbhub\\hubg": {
          "DisableSelectiveSuspend": { "Type": "REG_DWORD", "Data": 1 },
          "EnableDiagnosticMode": { "Type": "REG_DWORD", "Data": 0 }
      },
      "COMMANDS": {
        "UsbWmiDisablePower": {
          "Action": "run_powershell",
          "Command": "$mgmt=Get-WmiObject -Namespace 'root\\wmi' -Class MSPower_DeviceEnable; 'Win32_USBController','Win32_USBControllerDevice','Win32_USBHub' | % { Get-WmiObject -Class $_ -ea SilentlyContinue } | % { $pnp=$_.PNPDeviceID; if($pnp){ foreach($p in $mgmt){ if($p.InstanceName.ToUpper() -like ('*'+$pnp+'*')){ $p.Enable=$false; $p.PSBase.Put() | Out-Null } } } }"
        },
        "UsbDeviceParametersZero": {
          "Action": "registry_pattern",
          "Pattern": "HKLM\\SYSTEM\\CurrentControlSet\\Enum\\USB\\**\\Device Parameters",
          "Operations": [
            { "Name": "AllowIdleIrpInD3", "Type": "REG_DWORD", "Value": 0 },
            { "Name": "DeviceIdleEnabled", "Type": "REG_DWORD", "Value": 0 },
            { "Name": "DeviceSelectiveSuspended", "Type": "REG_DWORD", "Value": 0 },
            { "Name": "EnhancedPowerManagementEnabled", "Type": "REG_DWORD", "Value": 0 },
            { "Name": "EnhancedPowerManagementUseMonitor", "Type": "REG_DWORD", "Value": 0 },
            { "Name": "IdleSupported", "Type": "REG_DWORD", "Value": 0 },
            { "Name": "IdleTimeoutPeriodInMilliSec", "Type": "REG_DWORD", "Value": 0 },
            { "Name": "SelectiveSuspendEnabled", "Type": "REG_DWORD", "Value": 0 },
            { "Name": "SelectiveSuspendTimeout", "Type": "REG_DWORD", "Value": 0 },
            { "Name": "UserSetDeviceIdleEnabled", "Type": "REG_DWORD", "Value": 0 }
          ]
        },
        "UsbWdfParamsZero": {
          "Action": "registry_pattern",
          "Pattern": "HKLM\\SYSTEM\\CurrentControlSet\\Enum\\USB\\**\\Device Parameters\\Wdf",
          "Operations": [
            { "Name": "IdleInWorkingState", "Type": "REG_DWORD", "Value": 0 },
            { "Name": "SleepstudyState", "Type": "REG_DWORD", "Value": 0 },
            { "Name": "WdfDefaultIdleInWorkingState", "Type": "REG_DWORD", "Value": 0 },
            { "Name": "WdfDirectedPowerTransitionEnable", "Type": "REG_DWORD", "Value": 0 }
          ]
        },
        "UsbDevSubD3ColdZero": {
          "Action": "registry_pattern",
          "Pattern": "HKLM\\SYSTEM\\CurrentControlSet\\Enum\\USB\\**\\Device Parameters\\*",
          "ExcludeSubPaths": ["wdf"],
          "Operations": [
            { "Name": "D3ColdSupported", "Type": "REG_DWORD", "Value": 0 }
          ]
        }
      }
    },
    "revert": {
      "HKLM\\SYSTEM\\CurrentControlSet\\Services\\usbhub\\hubg": {
        "DisableSelectiveSuspend": { "Action": "deletevalue" },
        "EnableDiagnosticMode": { "Action": "deletevalue" }
      },
      "COMMANDS": {
        "UsbWmiEnablePower": {
          "Action": "run_powershell",
          "Command": "$mgmt=Get-WmiObject -Namespace 'root\\wmi' -Class MSPower_DeviceEnable; 'Win32_USBController','Win32_USBControllerDevice','Win32_USBHub' | % { Get-WmiObject -Class $_ -ea SilentlyContinue } | % { $pnp=$_.PNPDeviceID; if($pnp){ foreach($p in $mgmt){ if($p.InstanceName.ToUpper() -like ('*'+$pnp+'*')){ $p.Enable=$true; $p.PSBase.Put() | Out-Null } } } }"
        },
        "UsbDeviceParametersRevert": {
          "Action": "registry_pattern",
          "Pattern": "HKLM\\SYSTEM\\CurrentControlSet\\Enum\\USB\\**\\Device Parameters",
          "Operations": [
            { "Name": "AllowIdleIrpInD3", "Type": "REG_DWORD", "Value": 1 },
            { "Name": "DeviceIdleEnabled", "Type": "REG_DWORD", "Value": 1 },
            { "Name": "EnhancedPowerManagementEnabled", "Type": "REG_DWORD", "Value": 1 },
            { "Name": "DeviceSelectiveSuspended", "Operation": "delete" },
            { "Name": "EnhancedPowerManagementUseMonitor", "Operation": "delete" },
            { "Name": "IdleSupported", "Operation": "delete" },
            { "Name": "IdleTimeoutPeriodInMilliSec", "Operation": "delete" },
            { "Name": "SelectiveSuspendEnabled", "Operation": "delete" },
            { "Name": "SelectiveSuspendTimeout", "Operation": "delete" },
            { "Name": "UserSetDeviceIdleEnabled", "Operation": "delete" }
          ]
        },
        "UsbWdfParamsRevert": {
          "Action": "registry_pattern",
          "Pattern": "HKLM\\SYSTEM\\CurrentControlSet\\Enum\\USB\\**\\Device Parameters\\Wdf",
          "Operations": [
            { "Name": "IdleInWorkingState", "Operation": "delete" },
            { "Name": "WdfDirectedPowerTransitionEnable", "Operation": "delete" },
            { "Name": "SleepstudyState", "Operation": "delete" },
            { "Name": "WdfDefaultIdleInWorkingState", "Operation": "delete" }
          ]
        },
        "UsbDevSubD3ColdClear": {
          "Action": "registry_pattern",
          "Pattern": "HKLM\\SYSTEM\\CurrentControlSet\\Enum\\USB\\**\\Device Parameters\\*",
          "ExcludeSubPaths": ["wdf"],
          "Operations": [
            { "Name": "D3ColdSupported", "Operation": "delete" }
          ]
        }
      }
    }
  },
  "Disable Hibernation": {
    "apply": {
      "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Power": {
        "HibernateEnabled": { "Type": "REG_DWORD", "Data": 0 },
        "HibernateEnabledDefault": { "Type": "REG_DWORD", "Data": 0 },
        "AllowHibernate": { "Type": "REG_DWORD", "Data": 0 }
      }
    },
    "revert": {
      "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Power": {
        "HibernateEnabled": { "Type": "REG_DWORD", "Data": 1 },
        "HibernateEnabledDefault": { "Type": "REG_DWORD", "Data": 1 },
        "AllowHibernate": { "Type": "REG_DWORD", "Data": 1 }
      }
    }
  },
  "Remove Power Options": {
    "apply": {
      "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\FlyoutMenuSettings": {
        "ShowHibernateOption": { "Type": "REG_DWORD", "Data": 0 },
        "ShowLockOption": { "Type": "REG_DWORD", "Data": 0 },
        "ShowSleepOption": { "Type": "REG_DWORD", "Data": 0 }
      }
    },
    "revert": {
      "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\FlyoutMenuSettings": {
        "ShowHibernateOption": { "Action": "deletevalue" },
        "ShowLockOption": { "Action": "deletevalue" },
        "ShowSleepOption": { "Action": "deletevalue" }
      }
    }
  },
  "Disable Hiberboot": {
    "apply": {
      "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Power": {
        "HiberbootEnabled": { "Type": "REG_DWORD", "Data": 0 }
      },
      "HKLM\\Software\\Policies\\Microsoft\\Windows\\System": {
        "HiberbootEnabled": { "Type": "REG_DWORD", "Data": 0 }
      }
    },
    "revert": {
      "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Power": {
        "HiberbootEnabled": { "Type": "REG_DWORD", "Data": 1 }
      },
      "HKLM\\Software\\Policies\\Microsoft\\Windows\\System": {
        "HiberbootEnabled": { "Type": "REG_DWORD", "Data": 1 }
      }
    }
  },
  "Disable Power Throttling": {
    "apply": {
      "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Power\\PowerThrottling": {
        "PowerThrottlingOff": { "Type": "REG_DWORD", "Data": 1 }
      }
    },
    "revert": {
      "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Power\\PowerThrottling": {
        "PowerThrottlingOff": { "Type": "REG_DWORD", "Data": 0 }
      }
    }
  },
  "Disable Energy Estimation": {
    "apply": {
      "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Power": {
        "EnergyEstimationEnabled": { "Type": "REG_DWORD", "Data": 0 },
        "EnergyEstimationDisabled": { "Type": "REG_DWORD", "Data": 1 },
        "UserBatteryDischargeEstimator": { "Type": "REG_DWORD", "Data": 0 }
      }
    },
    "revert": {
      "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Power": {
        "EnergyEstimationEnabled": { "Type": "REG_DWORD", "Data": 1 },
        "EnergyEstimationDisabled": { "Action": "deletevalue" },
        "UserBatteryDischargeEstimator": { "Action": "deletevalue" }
      }
    }
  },
  "Disable HDD Parking": {
    "apply": {
      "COMMANDS": {
        "SetHddParking0": {
          "Action": "registry_pattern",
          "Pattern": "HKLM\\SYSTEM\\CurrentControlSet\\Services\\**",
          "Operations": [
            { "Name": "EnableHDDParking", "Type": "REG_DWORD", "Value": 0, "OnlyExisting": true }
          ]
        }
      }
    },
    "revert": {
      "COMMANDS": {
        "SetHddParking1": {
          "Action": "registry_pattern",
          "Pattern": "HKLM\\SYSTEM\\CurrentControlSet\\Services\\**",
          "Operations": [
            { "Name": "EnableHDDParking", "Type": "REG_DWORD", "Value": 1, "OnlyExisting": true }
          ]
        }
      }
    }
  },
  "Disable Storport Idle": {
    "apply": {
      "COMMANDS": {
        "StorportIdleOff": {
          "Action": "registry_pattern",
          "Pattern": "HKLM\\SYSTEM\\CurrentControlSet\\Enum\\**\\Device Parameters\\StorPort",
          "Operations": [
            { "Name": "EnableIdlePowerManagement", "Type": "REG_DWORD", "Value": 0 },
            { "Name": "DisableIdlePowerManagement", "Type": "REG_DWORD", "Value": 1 },
            { "Name": "DisableD3Cold", "Type": "REG_DWORD", "Value": 1 }
          ]
        }
      }
    },
    "revert": {
      "COMMANDS": {
        "StorportIdleOn": {
          "Action": "registry_pattern",
          "Pattern": "HKLM\\SYSTEM\\CurrentControlSet\\Enum\\**\\Device Parameters\\StorPort",
          "Operations": [
            { "Name": "EnableIdlePowerManagement", "Type": "REG_DWORD", "Value": 1 },
            { "Name": "DisableIdlePowerManagement", "Operation": "delete" },
            { "Name": "DisableD3Cold", "Operation": "delete" }
          ]
        }
      }
    }
  },
  "NoLazyMode": {
    "apply": {
      "HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Multimedia\\SystemProfile": {
        "NoLazyMode": { "Type": "REG_DWORD", "Data": 0 }
      }
    },
    "revert": {
      "HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Multimedia\\SystemProfile": {
        "NoLazyMode": { "Action": "deletevalue" }
      }
    }
  },
  "Disable Timer Coalescing": {
    "apply": {
      "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Power": {
        "CoalescingTimerInterval": { "Type": "REG_DWORD", "Data": 0 },
        "DeepIoCoalescingEnabled": { "Type": "REG_DWORD", "Data": 0 }
      },
      "HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Windows": {
        "RITdemonTimerPowerSaveCoalescing": { "Type": "REG_DWORD", "Data": 0 },
        "RITdemonTimerPowerSaveElapse": { "Type": "REG_DWORD", "Data": 0 }
      }
    },
    "revert": {
      "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Power": {
        "CoalescingTimerInterval": { "Action": "deletevalue" },
        "DeepIoCoalescingEnabled": { "Action": "deletevalue" }
      },
      "HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Windows": {
        "RITdemonTimerPowerSaveCoalescing": { "Action": "deletevalue" },
        "RITdemonTimerPowerSaveElapse": { "Action": "deletevalue" }
      }
    }
  },
  "Disable USB Battery Saver": {
    "apply": {
      "HKLM\\SYSTEM\\CurrentControlSet\\Control\\USB\\AutomaticSurpriseRemoval": {
        "AttemptRecoveryFromUsbPowerDrain": { "Type": "REG_DWORD", "Data": 0 }
      }
    },
    "revert": {
      "HKLM\\SYSTEM\\CurrentControlSet\\Control\\USB\\AutomaticSurpriseRemoval": {
        "AttemptRecoveryFromUsbPowerDrain": { "Type": "REG_DWORD", "Data": 1 }
      }
    }
  },
  "USB Flags": {
    "apply": {
      "HKLM\\SYSTEM\\CurrentControlSet\\Control\\usbflags": {
        "DisableHCS0Idle": { "Type": "REG_DWORD", "Data": 1 }
      }
    },
    "revert": {
      "HKLM\\SYSTEM\\CurrentControlSet\\Control\\usbflags": {
        "DisableHCS0Idle": { "Action": "deletevalue" }
      }
    }
  },
  "Disable Audio Idle": {
    "apply": {
      "COMMANDS": {
        "AudioIdleDisable": {
          "Action": "registry_pattern",
          "Pattern": "HKLM\\SYSTEM\\*ControlSet*\\Control\\Class\\{4d36e96c-e325-11ce-bfc1-08002be10318}\\**\\PowerSettings",
          "Operations": [
            { "Name": "IdlePowerState", "Type": "REG_BINARY", "Value": [0,0,0,0] },
            { "Name": "ConservationIdleTime", "Type": "REG_BINARY", "Value": [255,255,255,255] },
            { "Name": "PerformanceIdleTime", "Type": "REG_BINARY", "Value": [255,255,255,255] }
          ]
        }
      }
    },
    "revert": {
      "COMMANDS": {
        "AudioIdleDefaults": {
          "Action": "registry_pattern",
          "Pattern": "HKLM\\SYSTEM\\*ControlSet*\\Control\\Class\\{4d36e96c-e325-11ce-bfc1-08002be10318}\\**\\PowerSettings",
          "Operations": [
            { "Name": "ConservationIdleTime", "Type": "REG_BINARY", "Value": [30,0,0,0] },
            { "Name": "PerformanceIdleTime", "Type": "REG_BINARY", "Value": [0,0,0,0] },
            { "Name": "IdlePowerState", "Type": "REG_BINARY", "Value": [3,0,0,0] }
          ]
        }
      }
    }
  },
  "Disable NVMe Perf Throttling": {
    "apply": {
      "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Classpnp": {
        "NVMeDisablePerfThrottling": { "Type": "REG_DWORD", "Data": 1 }
      }
    },
    "revert": {
      "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Classpnp": {
        "NVMeDisablePerfThrottling": { "Type": "REG_DWORD", "Data": 1 }
      }
    }
  },
  "Disable Storage Idle States": {
    "apply": {
      "COMMANDS": {
        "StorageIdle": {
          "Action": "registry_pattern",
          "Pattern": "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Power\\EnergyEstimation\\Storage\\*",
          "Operations": [
            {"Name": "IdleStatesNumber", "Type": "REG_DWORD", "Value": 0 }
          ]
        }
      }
    },
    "revert": {
      "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Power\\EnergyEstimation\\Storage\\HDD": {
        "IdleStatesNumber": { "Type": "REG_DWORD", "Data": 3 }
      },
      "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Power\\EnergyEstimation\\Storage\\NVME": {
        "IdleStatesNumber": { "Type": "REG_DWORD", "Data": 1 }
      },
      "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Power\\EnergyEstimation\\Storage\\SD": {
        "IdleStatesNumber": { "Type": "REG_DWORD", "Data": 1 }
      },
      "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Power\\EnergyEstimation\\Storage\\SSD": {
        "IdleStatesNumber": { "Type": "REG_DWORD", "Data": 3 }
      }
    }
  },
  "Disable PM in Standby Mode": {
    "apply": {
      "HKLM\\Software\\Policies\\Microsoft\\Windows\\WcmSvc\\GroupPolicy": {
        "fDisablePowerManagement": { "Type": "REG_DWORD", "Data": 1 }
      },
      "HKLM\\Software\\Policies\\Microsoft\\Windows\\WcmSvc\\Local": {
        "fDisablePowerManagement": { "Type": "REG_DWORD", "Data": 1 }
      }
    },
    "revert": {
      "HKLM\\Software\\Policies\\Microsoft\\Windows\\WcmSvc\\GroupPolicy": {
        "fDisablePowerManagement": { "Action": "deletevalue" }
      },
      "HKLM\\Software\\Policies\\Microsoft\\Windows\\WcmSvc\\Local": {
        "fDisablePowerManagement": { "Action": "deletevalue" }
      }
    }
  }
}
