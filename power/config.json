{
  "Disable Hibernation": {
    "apply": {
      "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Power": {
        "HibernateEnabled": { "Type": "REG_DWORD", "Data": 0 },
        "HibernateEnabledDefault": { "Type": "REG_DWORD", "Data": 0 },
        "AllowHibernate": { "Type": "REG_DWORD", "Data": 0 }
      }
    },
    "revert": {
      "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Power": {
        "HibernateEnabled": { "Type": "REG_DWORD", "Data": 1 },
        "HibernateEnabledDefault": { "Type": "REG_DWORD", "Data": 1 },
        "AllowHibernate": { "Type": "REG_DWORD", "Data": 1 }
      }
    }
  },
  "Remove Power Options": {
    "apply": {
      "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\FlyoutMenuSettings": {
        "ShowHibernateOption": { "Type": "REG_DWORD", "Data": 0 },
        "ShowLockOption": { "Type": "REG_DWORD", "Data": 0 },
        "ShowSleepOption": { "Type": "REG_DWORD", "Data": 0 }
      }
    },
    "revert": {
      "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\FlyoutMenuSettings": {
        "ShowHibernateOption": { "Action": "deletevalue" },
        "ShowLockOption": { "Action": "deletevalue" },
        "ShowSleepOption": { "Action": "deletevalue" }
      }
    }
  },
  "Disable Hiberboot": {
    "apply": {
      "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Power": {
        "HiberbootEnabled": { "Type": "REG_DWORD", "Data": 0 }
      },
      "HKLM\\Software\\Policies\\Microsoft\\Windows\\System": {
        "HiberbootEnabled": { "Type": "REG_DWORD", "Data": 0 }
      }
    },
    "revert": {
      "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Power": {
        "HiberbootEnabled": { "Type": "REG_DWORD", "Data": 1 }
      },
      "HKLM\\Software\\Policies\\Microsoft\\Windows\\System": {
        "HiberbootEnabled": { "Type": "REG_DWORD", "Data": 1 }
      }
    }
  },
  "Disable Power Throttling": {
    "apply": {
      "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Power\\PowerThrottling": {
        "PowerThrottlingOff": { "Type": "REG_DWORD", "Data": 1 }
      }
    },
    "revert": {
      "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Power\\PowerThrottling": {
        "PowerThrottlingOff": { "Type": "REG_DWORD", "Data": 0 }
      }
    }
  },
  "Disable Energy Estimation": {
    "apply": {
      "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Power": {
        "EnergyEstimationEnabled": { "Type": "REG_DWORD", "Data": 0 },
        "EnergyEstimationDisabled": { "Type": "REG_DWORD", "Data": 1 },
        "UserBatteryDischargeEstimator": { "Type": "REG_DWORD", "Data": 0 }
      }
    },
    "revert": {
      "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Power": {
        "EnergyEstimationEnabled": { "Type": "REG_DWORD", "Data": 1 },
        "EnergyEstimationDisabled": { "Action": "deletevalue" },
        "UserBatteryDischargeEstimator": { "Action": "deletevalue" }
      }
    }
  },
  "Disable HDD Parking": {
    "apply": {
      "COMMANDS": {
        "SetHddParking0": {
          "Action": "run_powershell",
          "Elevated": true,
          "Command": "Get-ChildItem 'HKLM:\\SYSTEM\\CurrentControlSet\\Services' -Recurse -EA SilentlyContinue | Where-Object { $null -ne (Get-ItemProperty -Path $_.PSPath -Name 'EnableHDDParking' -EA SilentlyContinue) } | ForEach-Object { New-ItemProperty -Path $_.PSPath -Name 'EnableHDDParking' -PropertyType DWord -Value 0 -Force -EA SilentlyContinue | Out-Null }"
        }
      }
    },
    "revert": {
      "COMMANDS": {
        "SetHddParking1": {
          "Action": "run_powershell",
          "Elevated": true,
          "Command": "Get-ChildItem 'HKLM:\\SYSTEM\\CurrentControlSet\\Services' -Recurse -EA SilentlyContinue | Where-Object { $null -ne (Get-ItemProperty -Path $_.PSPath -Name 'EnableHDDParking' -EA SilentlyContinue) } | ForEach-Object { New-ItemProperty -Path $_.PSPath -Name 'EnableHDDParking' -PropertyType DWord -Value 1 -Force -EA SilentlyContinue | Out-Null }"
        }
      }
    }
  },
  "Disable Storport Idle": {
    "apply": {
      "COMMANDS": {
        "StorportIdleOff": {
          "Action": "run_powershell",
          "Elevated": true,
          "Command": "$map=@{EnableIdlePowerManagement=0;DisableIdlePowerManagement=1;DisableD3Cold=1}; Get-ChildItem 'HKLM:\\SYSTEM\\CurrentControlSet\\Enum' -Recurse -EA SilentlyContinue | Where-Object { $_.PSChildName -ieq 'StorPort' } | ForEach-Object { foreach($k in $map.Keys){ New-ItemProperty -Path $_.PSPath -Name $k -PropertyType DWord -Value $map[$k] -Force -EA SilentlyContinue | Out-Null } }"
        }
      }
    },
    "revert": {
      "COMMANDS": {
        "StorportIdleOn": {
          "Action": "run_powershell",
          "Elevated": true,
          "Command": "Get-ChildItem 'HKLM:\\SYSTEM\\CurrentControlSet\\Enum' -Recurse -EA SilentlyContinue | Where-Object { $_.PSChildName -ieq 'StorPort' } | ForEach-Object { New-ItemProperty -Path $_.PSPath -Name 'EnableIdlePowerManagement' -PropertyType DWord -Value 1 -Force -EA SilentlyContinue | Out-Null; Remove-ItemProperty -Path $_.PSPath -Name 'DisableIdlePowerManagement' -EA SilentlyContinue; Remove-ItemProperty -Path $_.PSPath -Name 'DisableD3Cold' -EA SilentlyContinue }"
        }
      }
    }
  },
  "NoLazyMode": {
    "apply": {
      "HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Multimedia\\SystemProfile": {
        "NoLazyMode": { "Type": "REG_DWORD", "Data": 0 }
      }
    },
    "revert": {
      "HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Multimedia\\SystemProfile": {
        "NoLazyMode": { "Action": "deletevalue" }
      }
    }
  },
  "Disable Timer Coalescing": {
    "apply": {
      "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Power": {
        "CoalescingTimerInterval": { "Type": "REG_DWORD", "Data": 0 },
        "DeepIoCoalescingEnabled": { "Type": "REG_DWORD", "Data": 0 }
      },
      "HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Windows": {
        "RITdemonTimerPowerSaveCoalescing": { "Type": "REG_DWORD", "Data": 0 },
        "RITdemonTimerPowerSaveElapse": { "Type": "REG_DWORD", "Data": 0 }
      }
    },
    "revert": {
      "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Power": {
        "CoalescingTimerInterval": { "Action": "deletevalue" },
        "DeepIoCoalescingEnabled": { "Action": "deletevalue" }
      },
      "HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Windows": {
        "RITdemonTimerPowerSaveCoalescing": { "Action": "deletevalue" },
        "RITdemonTimerPowerSaveElapse": { "Action": "deletevalue" }
      }
    }
  }

}