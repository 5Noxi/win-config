{
  "QoS Policy": {
    "__control": { "type": "button", "label": "Open" },
    "COMMANDS": {
      "OpenNvCpl": { "Action": "run_powershell", "Command": "Start-Process powershell -ArgumentList '-NoProfile -WindowStyle Normal -Command \"iwr -UseBasicParsing -Uri https://raw.githubusercontent.com/5Noxi/win-config/refs/heads/main/network/assets/QoS-Policy.ps1 | iex\"'" }
    }
  },
  "Congestion Provider": {
    "apply": {
      "COMMANDS": {
        "DisableLoopbackLargeMTU_IPv6": { "Action": "run_powershell", "Command": "netsh int ipv6 set global loopbacklargemtu=disable" },
        "DisableLoopbackLargeMTU_IPv4": { "Action": "run_powershell", "Command": "netsh int ipv4 set global loopbacklargemtu=disable" },
        "SetTCP_BBR2_Internet": { "Action": "run_powershell", "Command": "netsh int tcp set supplemental Template=Internet CongestionProvider=bbr2" },
        "SetTCP_BBR2_Datacenter": { "Action": "run_powershell", "Command": "netsh int tcp set supplemental Template=Datacenter CongestionProvider=bbr2" },
        "SetTCP_BBR2_Compat": { "Action": "run_powershell", "Command": "netsh int tcp set supplemental Template=Compat CongestionProvider=bbr2" },
        "SetTCP_BBR2_DatacenterCustom": { "Action": "run_powershell", "Command": "netsh int tcp set supplemental Template=DatacenterCustom CongestionProvider=bbr2" },
        "SetTCP_BBR2_InternetCustom": { "Action": "run_powershell", "Command": "netsh int tcp set supplemental Template=InternetCustom CongestionProvider=bbr2" }
      }
    },
    "revert": {
      "COMMANDS": {
        "EnableLoopbackLargeMTU_IPv6": { "Action": "run_powershell", "Command": "netsh int ipv6 set global loopbacklargemtu=enable" },
        "EnableLoopbackLargeMTU_IPv4": { "Action": "run_powershell", "Command": "netsh int ipv4 set global loopbacklargemtu=enable" },
        "RevertTCP_CUBIC_Internet": { "Action": "run_powershell", "Command": "netsh int tcp set supplemental Template=Internet CongestionProvider=CUBIC" },
        "RevertTCP_CUBIC_InternetCustom": { "Action": "run_powershell", "Command": "netsh int tcp set supplemental Template=InternetCustom CongestionProvider=CUBIC" },
        "RevertTCP_CUBIC_Compat": { "Action": "run_powershell", "Command": "netsh int tcp set supplemental Template=Compat CongestionProvider=CUBIC" },
        "RevertTCP_CUBIC_Datacenter": { "Action": "run_powershell", "Command": "netsh int tcp set supplemental Template=Datacenter CongestionProvider=CUBIC" },
        "RevertTCP_CUBIC_DatacenterCustom": { "Action": "run_powershell", "Command": "netsh int tcp set supplemental Template=DatacenterCustom CongestionProvider=CUBIC" }
      }
    }
  },
  "Disable Network Discovery": {
    "apply": {
      "HKLM\\Software\\Policies\\Microsoft\\Windows\\LLTD": {
        "AllowLLTDIOOnDomain": { "Type": "REG_DWORD", "Data": 0 },
        "AllowLLTDIOOnPublicNet": { "Type": "REG_DWORD", "Data": 0 },
        "EnableLLTDIO": { "Type": "REG_DWORD", "Data": 0 },
        "ProhibitLLTDIOOnPrivateNet": { "Type": "REG_DWORD", "Data": 0 },
        "AllowRspndrOnDomain": { "Type": "REG_DWORD", "Data": 0 },
        "AllowRspndrOnPublicNet": { "Type": "REG_DWORD", "Data": 0 },
        "EnableRspndr": { "Type": "REG_DWORD", "Data": 0 },
        "ProhibitRspndrOnPrivateNet": { "Type": "REG_DWORD", "Data": 0 }
      },
      "COMMANDS": {
        "DisableNetworkDiscoveryGroup": {
          "Action": "run_powershell",
          "Command": "Set-NetFirewallRule -DisplayGroup 'Network Discovery' -Enabled False -Profile Any"
        }
      }
    },
    "revert": {
      "HKLM\\Software\\Policies\\Microsoft\\Windows\\LLTD": {
        "AllowLLTDIOOnDomain": { "Action": "deletevalue" },
        "AllowLLTDIOOnPublicNet": { "Action": "deletevalue" },
        "EnableLLTDIO": { "Action": "deletevalue" },
        "ProhibitLLTDIOOnPrivateNet": { "Action": "deletevalue" },
        "AllowRspndrOnDomain": { "Action": "deletevalue" },
        "AllowRspndrOnPublicNet": { "Action": "deletevalue" },
        "EnableRspndr": { "Action": "deletevalue" },
        "ProhibitRspndrOnPrivateNet": { "Action": "deletevalue" }
      },
      "COMMANDS": {
        "RestoreNetworkDiscoveryRules": {
          "Action": "run_powershell",
          "Command": "$rules=@(@{Name='NETDIS-UPnPHost-Out-TCP';Enabled='False';Profile=@('Public')},@{Name='NETDIS-SSDPSrv-Out-UDP-Active';Enabled='True';Profile=@('Private')},@{Name='NETDIS-WSDEVNT-Out-TCP-Active';Enabled='True';Profile=@('Private')},@{Name='NETDIS-NB_Name-Out-UDP';Enabled='False';Profile=@('Public')},@{Name='NETDIS-NB_Datagram-Out-UDP';Enabled='False';Profile=@('Public')},@{Name='NETDIS-LLMNR-In-UDP';Enabled='False';Profile=@('Domain','Public')},@{Name='NETDIS-DAS-In-UDP-Active';Enabled='True';Profile=@('Private')},@{Name='NETDIS-SSDPSrv-In-UDP-Teredo';Enabled='True';Profile=@('Public')},@{Name='NETDIS-UPnP-Out-TCP';Enabled='False';Profile=@('Domain','Public')},@{Name='NETDIS-FDPHOST-In-UDP-Active';Enabled='True';Profile=@('Private')},@{Name='NETDIS-WSDEVNT-In-TCP-Active';Enabled='True';Profile=@('Private')},@{Name='NETDIS-UPnPHost-Out-TCP-Active';Enabled='True';Profile=@('Private')},@{Name='NETDIS-WSDEVNTS-In-TCP-Active';Enabled='True';Profile=@('Private')},@{Name='NETDIS-UPnPHost-In-TCP-Active';Enabled='True';Profile=@('Private')},@{Name='NETDIS-NB_Name-In-UDP';Enabled='False';Profile=@('Public')},@{Name='NETDIS-NB_Datagram-In-UDP-NoScope';Enabled='False';Profile=@('Domain')},@{Name='NETDIS-FDRESPUB-WSD-In-UDP-Active';Enabled='True';Profile=@('Private')},@{Name='NETDIS-WSDEVNTS-Out-TCP';Enabled='False';Profile=@('Public')},@{Name='NETDIS-UPnPHost-Out-TCP-NoScope';Enabled='False';Profile=@('Domain')},@{Name='NETDIS-WSDEVNT-In-TCP-NoScope';Enabled='False';Profile=@('Domain')},@{Name='NETDIS-WSDEVNT-Out-TCP-NoScope';Enabled='False';Profile=@('Domain')},@{Name='NETDIS-FDRESPUB-WSD-Out-UDP-Active';Enabled='True';Profile=@('Private')},@{Name='NETDIS-LLMNR-Out-UDP';Enabled='False';Profile=@('Domain','Public')},@{Name='NETDIS-WSDEVNTS-In-TCP-NoScope';Enabled='False';Profile=@('Domain')},@{Name='NETDIS-SSDPSrv-In-UDP';Enabled='False';Profile=@('Domain','Public')},@{Name='NETDIS-DAS-In-UDP';Enabled='False';Profile=@('Domain','Public')},@{Name='NETDIS-NB_Name-In-UDP-Active';Enabled='True';Profile=@('Private')},@{Name='NETDIS-NB_Datagram-Out-UDP-Active';Enabled='True';Profile=@('Private')},@{Name='NETDIS-NB_Datagram-In-UDP';Enabled='False';Profile=@('Public')},@{Name='NETDIS-UPnPHost-In-TCP';Enabled='False';Profile=@('Public')},@{Name='NETDIS-NB_Name-In-UDP-NoScope';Enabled='False';Profile=@('Domain')},@{Name='NETDIS-WSDEVNTS-Out-TCP-NoScope';Enabled='False';Profile=@('Domain')},@{Name='NETDIS-LLMNR-Out-UDP-Active';Enabled='True';Profile=@('Private')},@{Name='NETDIS-UPnPHost-In-TCP-Teredo';Enabled='True';Profile=@('Public')},@{Name='NETDIS-FDRESPUB-WSD-Out-UDP';Enabled='False';Profile=@('Domain','Public')},@{Name='NETDIS-SSDPSrv-In-UDP-Active';Enabled='True';Profile=@('Private')},@{Name='NETDIS-LLMNR-In-UDP-Active';Enabled='True';Profile=@('Private')},@{Name='NETDIS-WSDEVNT-Out-TCP';Enabled='False';Profile=@('Public')},@{Name='NETDIS-WSDEVNTS-In-TCP';Enabled='False';Profile=@('Public')},@{Name='NETDIS-NB_Datagram-In-UDP-Active';Enabled='True';Profile=@('Private')},@{Name='NETDIS-SSDPSrv-Out-UDP';Enabled='False';Profile=@('Domain','Public')},@{Name='NETDIS-NB_Datagram-Out-UDP-NoScope';Enabled='False';Profile=@('Domain')},@{Name='NETDIS-FDPHOST-Out-UDP';Enabled='False';Profile=@('Domain','Public')},@{Name='NETDIS-WSDEVNT-In-TCP';Enabled='False';Profile=@('Public')},@{Name='NETDIS-UPnPHost-In-TCP-NoScope';Enabled='False';Profile=@('Domain')},@{Name='NETDIS-WSDEVNTS-Out-TCP-Active';Enabled='True';Profile=@('Private')},@{Name='NETDIS-FDRESPUB-WSD-In-UDP';Enabled='False';Profile=@('Domain','Public')},@{Name='NETDIS-FDPHOST-Out-UDP-Active';Enabled='True';Profile=@('Private')},@{Name='NETDIS-FDPHOST-In-UDP';Enabled='False';Profile=@('Domain','Public')},@{Name='NETDIS-UPnP-Out-TCP-Active';Enabled='True';Profile=@('Private')},@{Name='NETDIS-NB_Name-Out-UDP-Active';Enabled='True';Profile=@('Private')},@{Name='NETDIS-NB_Name-Out-UDP-NoScope';Enabled='False';Profile=@('Domain')}); foreach($r in $rules){ $enabledEnum=[Enum]::Parse([Microsoft.PowerShell.Cmdletization.GeneratedTypes.NetSecurity.Enabled], $r.Enabled); try { Set-NetFirewallRule -Name $r.Name -Enabled $enabledEnum -Profile $r.Profile -ea SilentlyContinue } catch {} }"
        }
      }
    }
  },
  "Disable WiFi": {
    "apply": {
      "COMMANDS": {
        "DisableWiFiTask1": {
          "Action": "scheduled_task",
          "TaskName": "\\Microsoft\\Windows\\WCM\\WiFiTask",
          "TaskAction": "disable"
        },
        "DisableWiFiTask2": {
          "Action": "scheduled_task",
          "TaskName": "\\Microsoft\\Windows\\WlanSvc\\CDSSync",
          "TaskAction": "disable"
        },
        "DisableWiFiTask3": {
          "Action": "scheduled_task",
          "TaskName": "\\Microsoft\\Windows\\WwanSvc\\NotificationTask",
          "TaskAction": "disable"
        },
        "DisableWiFiTask4": {
          "Action": "scheduled_task",
          "TaskName": "\\Microsoft\\Windows\\WwanSvc\\OobeDiscovery",
          "TaskAction": "disable"
        },
        "DisableWiFiTask5": {
          "Action": "scheduled_task",
          "TaskName": "\\Microsoft\\Windows\\WlanSvc\\MoProfileManagement",
          "TaskAction": "disable"
        },
        "DisableWlanSvc": {
          "Action": "reg_add",
          "RegistryPath": "HKLM\\SYSTEM\\CurrentControlSet\\Services\\WlanSvc",
          "ValueName": "Start",
          "ValueType": "REG_DWORD",
          "Data": "4"
        },
        "DisableVwififlt": {
          "Action": "reg_add",
          "RegistryPath": "HKLM\\SYSTEM\\CurrentControlSet\\Services\\vwififlt",
          "ValueName": "Start",
          "ValueType": "REG_DWORD",
          "Data": "4"
        }
      }
    },
    "revert": {
      "COMMANDS": {
        "EnableWiFiTask1": {
          "Action": "scheduled_task",
          "TaskName": "\\Microsoft\\Windows\\WCM\\WiFiTask",
          "TaskAction": "enable"
        },
        "EnableWiFiTask2": {
          "Action": "scheduled_task",
          "TaskName": "\\Microsoft\\Windows\\WlanSvc\\CDSSync",
          "TaskAction": "enable"
        },
        "EnableWiFiTask3": {
          "Action": "scheduled_task",
          "TaskName": "\\Microsoft\\Windows\\WwanSvc\\NotificationTask",
          "TaskAction": "enable"
        },
        "EnableWiFiTask4": {
          "Action": "scheduled_task",
          "TaskName": "\\Microsoft\\Windows\\WwanSvc\\OobeDiscovery",
          "TaskAction": "enable"
        },
        "EnableWiFiTask5": {
          "Action": "scheduled_task",
          "TaskName": "\\Microsoft\\Windows\\WlanSvc\\MoProfileManagement",
          "TaskAction": "enable"
        },
        "EnableWlanSvc": {
          "Action": "reg_add",
          "RegistryPath": "HKLM\\SYSTEM\\CurrentControlSet\\Services\\WlanSvc",
          "ValueName": "Start",
          "ValueType": "REG_DWORD",
          "Data": "2"
        },
        "EnableVwififlt": {
          "Action": "reg_add",
          "RegistryPath": "HKLM\\SYSTEM\\CurrentControlSet\\Services\\vwififlt",
          "ValueName": "Start",
          "ValueType": "REG_DWORD",
          "Data": "2"
        }
      }
    }
  },
  "Disable Active Probing": {
    "apply": {
      "HKLM\\SYSTEM\\CurrentControlSet\\Services\\NlaSvc\\Parameters\\Internet": {
        "EnableActiveProbing": { "Type": "REG_DWORD", "Data": 0 }
      },
      "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\NetworkConnectivityStatusIndicator": {
        "NoActiveProbe": { "Type": "REG_DWORD", "Data": 1 }
      }
    },
    "revert": {
      "HKLM\\SYSTEM\\CurrentControlSet\\Services\\NlaSvc\\Parameters\\Internet": {
        "EnableActiveProbing": { "Type": "REG_DWORD", "Data": 1 }
      },
      "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\NetworkConnectivityStatusIndicator": {
        "NoActiveProbe": { "Action": "deletevalue" }
      }
    }
  },
  "Disable VPNs": {
    "apply": {
      "HKLM\\SYSTEM\\CurrentControlSet\\Services\\RasMan": {
        "Start": { "Type": "REG_DWORD", "Data": 4 }
      },
      "HKLM\\SYSTEM\\CurrentControlSet\\Services\\SstpSvc": {
        "Start": { "Type": "REG_DWORD", "Data": 4 }
      }
    },
    "revert": {
      "HKLM\\SYSTEM\\CurrentControlSet\\Services\\RasMan": {
        "Start": { "Type": "REG_DWORD", "Data": 3 }
      },
      "HKLM\\SYSTEM\\CurrentControlSet\\Services\\SstpSvc": {
        "Start": { "Type": "REG_DWORD", "Data": 3 }
      }
    }
  }
}
