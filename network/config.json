{
  "QoS Policy": {
    "__control": { "type": "button", "label": "Open" },
    "COMMANDS": {
      "OpenNvCpl": { "Action": "run_powershell", "Command": "Start-Process powershell -ArgumentList '-NoProfile -WindowStyle Normal -Command \"iwr -UseBasicParsing -Uri https://raw.githubusercontent.com/5Noxi/win-config/refs/heads/main/network/assets/QoS-Policy.ps1 | iex\"'" }
    }
  },
  "Congestion Provider": {
    "apply": {
      "COMMANDS": {
        "DisableLoopbackLargeMTU_IPv6": { "Action": "run_powershell", "Command": "netsh int ipv6 set global loopbacklargemtu=disable" },
        "DisableLoopbackLargeMTU_IPv4": { "Action": "run_powershell", "Command": "netsh int ipv4 set global loopbacklargemtu=disable" },
        "SetTCP_BBR2_Internet": { "Action": "run_powershell", "Command": "netsh int tcp set supplemental Template=Internet CongestionProvider=bbr2" },
        "SetTCP_BBR2_Datacenter": { "Action": "run_powershell", "Command": "netsh int tcp set supplemental Template=Datacenter CongestionProvider=bbr2" },
        "SetTCP_BBR2_Compat": { "Action": "run_powershell", "Command": "netsh int tcp set supplemental Template=Compat CongestionProvider=bbr2" },
        "SetTCP_BBR2_DatacenterCustom": { "Action": "run_powershell", "Command": "netsh int tcp set supplemental Template=DatacenterCustom CongestionProvider=bbr2" },
        "SetTCP_BBR2_InternetCustom": { "Action": "run_powershell", "Command": "netsh int tcp set supplemental Template=InternetCustom CongestionProvider=bbr2" }
      }
    },
    "revert": {
      "COMMANDS": {
        "EnableLoopbackLargeMTU_IPv6": { "Action": "run_powershell", "Command": "netsh int ipv6 set global loopbacklargemtu=enable" },
        "EnableLoopbackLargeMTU_IPv4": { "Action": "run_powershell", "Command": "netsh int ipv4 set global loopbacklargemtu=enable" },
        "RevertTCP_CUBIC_Internet": { "Action": "run_powershell", "Command": "netsh int tcp set supplemental Template=Internet CongestionProvider=CUBIC" },
        "RevertTCP_CUBIC_InternetCustom": { "Action": "run_powershell", "Command": "netsh int tcp set supplemental Template=InternetCustom CongestionProvider=CUBIC" },
        "RevertTCP_CUBIC_Compat": { "Action": "run_powershell", "Command": "netsh int tcp set supplemental Template=Compat CongestionProvider=CUBIC" },
        "RevertTCP_CUBIC_Datacenter": { "Action": "run_powershell", "Command": "netsh int tcp set supplemental Template=Datacenter CongestionProvider=CUBIC" },
        "RevertTCP_CUBIC_DatacenterCustom": { "Action": "run_powershell", "Command": "netsh int tcp set supplemental Template=DatacenterCustom CongestionProvider=CUBIC" }
      }
    }
  },
  "Disable WiFi": {
    "apply": {
      "COMMANDS": {
        "DisableWiFiTask1": {
          "Action": "scheduled_task",
          "TaskName": "\\Microsoft\\Windows\\WCM\\WiFiTask",
          "TaskAction": "disable"
        },
        "DisableWiFiTask2": {
          "Action": "scheduled_task",
          "TaskName": "\\Microsoft\\Windows\\WlanSvc\\CDSSync",
          "TaskAction": "disable"
        },
        "DisableWiFiTask3": {
          "Action": "scheduled_task",
          "TaskName": "\\Microsoft\\Windows\\WwanSvc\\NotificationTask",
          "TaskAction": "disable"
        },
        "DisableWiFiTask4": {
          "Action": "scheduled_task",
          "TaskName": "\\Microsoft\\Windows\\WwanSvc\\OobeDiscovery",
          "TaskAction": "disable"
        },
        "DisableWiFiTask5": {
          "Action": "scheduled_task",
          "TaskName": "\\Microsoft\\Windows\\WlanSvc\\MoProfileManagement",
          "TaskAction": "disable"
        },
        "DisableWlanSvc": {
          "Action": "reg_add",
          "RegistryPath": "HKLM\\SYSTEM\\CurrentControlSet\\Services\\WlanSvc",
          "ValueName": "Start",
          "ValueType": "REG_DWORD",
          "Data": "4"
        },
        "DisableVwififlt": {
          "Action": "reg_add",
          "RegistryPath": "HKLM\\SYSTEM\\CurrentControlSet\\Services\\vwififlt",
          "ValueName": "Start",
          "ValueType": "REG_DWORD",
          "Data": "4"
        }
      }
    },
    "revert": {
      "COMMANDS": {
        "EnableWiFiTask1": {
          "Action": "scheduled_task",
          "TaskName": "\\Microsoft\\Windows\\WCM\\WiFiTask",
          "TaskAction": "enable"
        },
        "EnableWiFiTask2": {
          "Action": "scheduled_task",
          "TaskName": "\\Microsoft\\Windows\\WlanSvc\\CDSSync",
          "TaskAction": "enable"
        },
        "EnableWiFiTask3": {
          "Action": "scheduled_task",
          "TaskName": "\\Microsoft\\Windows\\WwanSvc\\NotificationTask",
          "TaskAction": "enable"
        },
        "EnableWiFiTask4": {
          "Action": "scheduled_task",
          "TaskName": "\\Microsoft\\Windows\\WwanSvc\\OobeDiscovery",
          "TaskAction": "enable"
        },
        "EnableWiFiTask5": {
          "Action": "scheduled_task",
          "TaskName": "\\Microsoft\\Windows\\WlanSvc\\MoProfileManagement",
          "TaskAction": "enable"
        },
        "EnableWlanSvc": {
          "Action": "reg_add",
          "RegistryPath": "HKLM\\SYSTEM\\CurrentControlSet\\Services\\WlanSvc",
          "ValueName": "Start",
          "ValueType": "REG_DWORD",
          "Data": "2"
        },
        "EnableVwififlt": {
          "Action": "reg_add",
          "RegistryPath": "HKLM\\SYSTEM\\CurrentControlSet\\Services\\vwififlt",
          "ValueName": "Start",
          "ValueType": "REG_DWORD",
          "Data": "2"
        }
      }
    }
  },
  "Disable Active Probing": {
    "apply": {
      "HKLM\\SYSTEM\\CurrentControlSet\\Services\\NlaSvc\\Parameters\\Internet": {
        "EnableActiveProbing": { "Type": "REG_DWORD", "Data": 0 }
      },
      "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\NetworkConnectivityStatusIndicator": {
        "NoActiveProbe": { "Type": "REG_DWORD", "Data": 1 }
      }
    },
    "revert": {
      "HKLM\\SYSTEM\\CurrentControlSet\\Services\\NlaSvc\\Parameters\\Internet": {
        "EnableActiveProbing": { "Type": "REG_DWORD", "Data": 1 }
      },
      "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\NetworkConnectivityStatusIndicator": {
        "NoActiveProbe": { "Action": "deletevalue" }
      }
    }
  },
  "Disable VPNs": {
    "apply": {
      "HKLM\\SYSTEM\\CurrentControlSet\\Services\\RasMan": {
        "Start": { "Type": "REG_DWORD", "Data": 4 }
      },
      "HKLM\\SYSTEM\\CurrentControlSet\\Services\\SstpSvc": {
        "Start": { "Type": "REG_DWORD", "Data": 4 }
      }
    },
    "revert": {
      "HKLM\\SYSTEM\\CurrentControlSet\\Services\\RasMan": {
        "Start": { "Type": "REG_DWORD", "Data": 3 }
      },
      "HKLM\\SYSTEM\\CurrentControlSet\\Services\\SstpSvc": {
        "Start": { "Type": "REG_DWORD", "Data": 3 }
      }
    }
  }
}
