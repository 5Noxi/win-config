{
  "SMB Configuration": {
    "apply": {
      "HKLM\\SYSTEM\\CurrentControlSet\\Services\\LanmanWorkstation\\Parameters": {
        "DisableBandwidthThrottling": { "Type": "REG_DWORD", "Data": 1 },
        "DisableLargeMtu": { "Type": "REG_DWORD", "Data": 0 },
        "RequireSecuritySignature": { "Type": "REG_DWORD", "Data": 1 },
        "EnableSecuritySignature": { "Type": "REG_DWORD", "Data": 1 },
        "CipherSuiteOrder": { "Type": "REG_MULTI_SZ", "Data": "AES_256_GCM,AES_256_CCM" },
        "DisableMultiChannel": { "Type": "REG_DWORD", "Data": 0 },
        "EnableSMBQUIC": { "Type": "REG_DWORD", "Data": 1 },
        "MaxSmb2Dialect": { "Type": "REG_DWORD", "Data": 65536 },
        "MinSmb2Dialect": { "Type": "REG_DWORD", "Data": 785 }
      },
      "HKLM\\SYSTEM\\CurrentControlSet\\Services\\LanmanServer\\Parameters": {
        "RequireSecuritySignature": { "Type": "REG_DWORD", "Data": 1 },
        "enablesecuritysignature": { "Type": "REG_DWORD", "Data": 1 },
        "EncryptData": { "Type": "REG_DWORD", "Data": 1 },
        "CipherSuiteOrder": { "Type": "REG_MULTI_SZ", "Data": "AES_256_GCM,AES_256_CCM" },
        "RejectUnencryptedAccess": { "Type": "REG_DWORD", "Data": 1 },
        "DisableLeasing": { "Type": "REG_DWORD", "Data": 1 },
        "EnableSMBQUIC": { "Type": "REG_DWORD", "Data": 1 },
        "MaxSmb2Dialect": { "Type": "REG_DWORD", "Data": 65536 },
        "MinSmb2Dialect": { "Type": "REG_DWORD", "Data": 785 },
        "AutoShareServer": { "Type": "REG_DWORD", "Data": 0 },
        "AutoShareWks": { "Type": "REG_DWORD", "Data": 0 }
      }
    },
    "revert": {
      "HKLM\\SYSTEM\\CurrentControlSet\\Services\\LanmanWorkstation\\Parameters": {
        "DisableBandwidthThrottling": { "Action": "deletevalue" },
        "DisableLargeMtu": { "Action": "deletevalue" },
        "RequireSecuritySignature": { "Action": "deletevalue" },
        "EnableSecuritySignature": { "Type": "REG_DWORD", "Data": 1 },
        "CipherSuiteOrder": { "Action": "deletevalue" },
        "DisableMultiChannel": { "Action": "deletevalue" },
        "EnableSMBQUIC": { "Action": "deletevalue" },
        "MaxSmb2Dialect": { "Action": "deletevalue" },
        "MinSmb2Dialect": { "Action": "deletevalue" }
      },
      "HKLM\\SYSTEM\\CurrentControlSet\\Services\\LanmanServer\\Parameters": {
        "RequireSecuritySignature": { "Action": "deletevalue" },
        "enablesecuritysignature": { "Type": "REG_DWORD", "Data": 0 },
        "EncryptData": { "Action": "deletevalue" },
        "CipherSuiteOrder": { "Action": "deletevalue" },
        "RejectUnencryptedAccess": { "Action": "deletevalue" },
        "DisableLeasing": { "Action": "deletevalue" },
        "EnableSMBQUIC": { "Action": "deletevalue" },
        "MaxSmb2Dialect": { "Action": "deletevalue" },
        "MinSmb2Dialect": { "Action": "deletevalue" },
        "AutoShareServer": { "Action": "deletevalue" },
        "AutoShareWks": { "Action": "deletevalue" }
      }
    }
  },
  "QoS Policy": {
    "__control": { "type": "button", "label": "Open" },
    "COMMANDS": {
      "OpenNvCpl": { "Action": "run_powershell", "Command": "Start-Process powershell -ArgumentList '-NoProfile -WindowStyle Normal -Command \"iwr -UseBasicParsing -Uri https://raw.githubusercontent.com/5Noxi/win-config/refs/heads/main/network/assets/QoS-Policy.ps1 | iex\"'" }
    }
  },
  "Congestion Provider": {
    "apply": {
      "COMMANDS": {
        "DisableLoopbackLargeMTU_IPv6": {
          "Action": "loopback_mtu",
          "Protocol": "ipv6",
          "Enable": false
        },
        "DisableLoopbackLargeMTU_IPv4": {
          "Action": "loopback_mtu",
          "Protocol": "ipv4",
          "Enable": false
        },
        "SetTCP_BBR2": {
          "Action": "tcp_congestion",
          "Templates": [
            "Internet",
            "Datacenter",
            "Compat",
            "DatacenterCustom",
            "InternetCustom"
          ],
          "Provider": "bbr2"
        }
      }
    },
    "revert": {
      "COMMANDS": {
        "EnableLoopbackLargeMTU_IPv6": {
          "Action": "loopback_mtu",
          "Protocol": "ipv6",
          "Enable": true
        },
        "EnableLoopbackLargeMTU_IPv4": {
          "Action": "loopback_mtu",
          "Protocol": "ipv4",
          "Enable": true
        },
        "RevertTCP_CUBIC": {
          "Action": "tcp_congestion",
          "Templates": [
            "Internet",
            "InternetCustom",
            "Compat",
            "Datacenter",
            "DatacenterCustom"
          ],
          "Provider": "CUBIC"
        }
      }
    }
  },
  "Disable Network Discovery": {
    "apply": {
      "HKLM\\Software\\Policies\\Microsoft\\Windows\\LLTD": {
        "AllowLLTDIOOnDomain": { "Type": "REG_DWORD", "Data": 0 },
        "AllowLLTDIOOnPublicNet": { "Type": "REG_DWORD", "Data": 0 },
        "EnableLLTDIO": { "Type": "REG_DWORD", "Data": 0 },
        "ProhibitLLTDIOOnPrivateNet": { "Type": "REG_DWORD", "Data": 0 },
        "AllowRspndrOnDomain": { "Type": "REG_DWORD", "Data": 0 },
        "AllowRspndrOnPublicNet": { "Type": "REG_DWORD", "Data": 0 },
        "EnableRspndr": { "Type": "REG_DWORD", "Data": 0 },
        "ProhibitRspndrOnPrivateNet": { "Type": "REG_DWORD", "Data": 0 }
      },
      "COMMANDS": {
        "DisableNetworkDiscoveryGroup": {
          "Action": "run_powershell",
          "Command": "Set-NetFirewallRule -DisplayGroup 'Network Discovery' -Enabled False -Profile Any"
        },
        "DisableLLTDIORspndr": {
          "Action": "netbind",
          "ComponentID": [
            "ms_lltdio",
            "ms_rspndr"
          ],
          "State": "disable"
        }
      }
    },
    "revert": {
      "HKLM\\Software\\Policies\\Microsoft\\Windows\\LLTD": {
        "AllowLLTDIOOnDomain": { "Action": "deletevalue" },
        "AllowLLTDIOOnPublicNet": { "Action": "deletevalue" },
        "EnableLLTDIO": { "Action": "deletevalue" },
        "ProhibitLLTDIOOnPrivateNet": { "Action": "deletevalue" },
        "AllowRspndrOnDomain": { "Action": "deletevalue" },
        "AllowRspndrOnPublicNet": { "Action": "deletevalue" },
        "EnableRspndr": { "Action": "deletevalue" },
        "ProhibitRspndrOnPrivateNet": { "Action": "deletevalue" }
      },
      "COMMANDS": {
        "RestoreNetworkDiscoveryRules": {
          "Action": "run_powershell",
          "Command": "$rules=@(@{Name='NETDIS-UPnPHost-Out-TCP';Enabled='False';Profile=@('Public')},@{Name='NETDIS-SSDPSrv-Out-UDP-Active';Enabled='True';Profile=@('Private')},@{Name='NETDIS-WSDEVNT-Out-TCP-Active';Enabled='True';Profile=@('Private')},@{Name='NETDIS-NB_Name-Out-UDP';Enabled='False';Profile=@('Public')},@{Name='NETDIS-NB_Datagram-Out-UDP';Enabled='False';Profile=@('Public')},@{Name='NETDIS-LLMNR-In-UDP';Enabled='False';Profile=@('Domain','Public')},@{Name='NETDIS-DAS-In-UDP-Active';Enabled='True';Profile=@('Private')},@{Name='NETDIS-SSDPSrv-In-UDP-Teredo';Enabled='True';Profile=@('Public')},@{Name='NETDIS-UPnP-Out-TCP';Enabled='False';Profile=@('Domain','Public')},@{Name='NETDIS-FDPHOST-In-UDP-Active';Enabled='True';Profile=@('Private')},@{Name='NETDIS-WSDEVNT-In-TCP-Active';Enabled='True';Profile=@('Private')},@{Name='NETDIS-UPnPHost-Out-TCP-Active';Enabled='True';Profile=@('Private')},@{Name='NETDIS-WSDEVNTS-In-TCP-Active';Enabled='True';Profile=@('Private')},@{Name='NETDIS-UPnPHost-In-TCP-Active';Enabled='True';Profile=@('Private')},@{Name='NETDIS-NB_Name-In-UDP';Enabled='False';Profile=@('Public')},@{Name='NETDIS-NB_Datagram-In-UDP-NoScope';Enabled='False';Profile=@('Domain')},@{Name='NETDIS-FDRESPUB-WSD-In-UDP-Active';Enabled='True';Profile=@('Private')},@{Name='NETDIS-WSDEVNTS-Out-TCP';Enabled='False';Profile=@('Public')},@{Name='NETDIS-UPnPHost-Out-TCP-NoScope';Enabled='False';Profile=@('Domain')},@{Name='NETDIS-WSDEVNT-In-TCP-NoScope';Enabled='False';Profile=@('Domain')},@{Name='NETDIS-WSDEVNT-Out-TCP-NoScope';Enabled='False';Profile=@('Domain')},@{Name='NETDIS-FDRESPUB-WSD-Out-UDP-Active';Enabled='True';Profile=@('Private')},@{Name='NETDIS-LLMNR-Out-UDP';Enabled='False';Profile=@('Domain','Public')},@{Name='NETDIS-WSDEVNTS-In-TCP-NoScope';Enabled='False';Profile=@('Domain')},@{Name='NETDIS-SSDPSrv-In-UDP';Enabled='False';Profile=@('Domain','Public')},@{Name='NETDIS-DAS-In-UDP';Enabled='False';Profile=@('Domain','Public')},@{Name='NETDIS-NB_Name-In-UDP-Active';Enabled='True';Profile=@('Private')},@{Name='NETDIS-NB_Datagram-Out-UDP-Active';Enabled='True';Profile=@('Private')},@{Name='NETDIS-NB_Datagram-In-UDP';Enabled='False';Profile=@('Public')},@{Name='NETDIS-UPnPHost-In-TCP';Enabled='False';Profile=@('Public')},@{Name='NETDIS-NB_Name-In-UDP-NoScope';Enabled='False';Profile=@('Domain')},@{Name='NETDIS-WSDEVNTS-Out-TCP-NoScope';Enabled='False';Profile=@('Domain')},@{Name='NETDIS-LLMNR-Out-UDP-Active';Enabled='True';Profile=@('Private')},@{Name='NETDIS-UPnPHost-In-TCP-Teredo';Enabled='True';Profile=@('Public')},@{Name='NETDIS-FDRESPUB-WSD-Out-UDP';Enabled='False';Profile=@('Domain','Public')},@{Name='NETDIS-SSDPSrv-In-UDP-Active';Enabled='True';Profile=@('Private')},@{Name='NETDIS-LLMNR-In-UDP-Active';Enabled='True';Profile=@('Private')},@{Name='NETDIS-WSDEVNT-Out-TCP';Enabled='False';Profile=@('Public')},@{Name='NETDIS-WSDEVNTS-In-TCP';Enabled='False';Profile=@('Public')},@{Name='NETDIS-NB_Datagram-In-UDP-Active';Enabled='True';Profile=@('Private')},@{Name='NETDIS-SSDPSrv-Out-UDP';Enabled='False';Profile=@('Domain','Public')},@{Name='NETDIS-NB_Datagram-Out-UDP-NoScope';Enabled='False';Profile=@('Domain')},@{Name='NETDIS-FDPHOST-Out-UDP';Enabled='False';Profile=@('Domain','Public')},@{Name='NETDIS-WSDEVNT-In-TCP';Enabled='False';Profile=@('Public')},@{Name='NETDIS-UPnPHost-In-TCP-NoScope';Enabled='False';Profile=@('Domain')},@{Name='NETDIS-WSDEVNTS-Out-TCP-Active';Enabled='True';Profile=@('Private')},@{Name='NETDIS-FDRESPUB-WSD-In-UDP';Enabled='False';Profile=@('Domain','Public')},@{Name='NETDIS-FDPHOST-Out-UDP-Active';Enabled='True';Profile=@('Private')},@{Name='NETDIS-FDPHOST-In-UDP';Enabled='False';Profile=@('Domain','Public')},@{Name='NETDIS-UPnP-Out-TCP-Active';Enabled='True';Profile=@('Private')},@{Name='NETDIS-NB_Name-Out-UDP-Active';Enabled='True';Profile=@('Private')},@{Name='NETDIS-NB_Name-Out-UDP-NoScope';Enabled='False';Profile=@('Domain')}); foreach($r in $rules){ $enabledEnum=[Enum]::Parse([Microsoft.PowerShell.Cmdletization.GeneratedTypes.NetSecurity.Enabled], $r.Enabled); try { Set-NetFirewallRule -Name $r.Name -Enabled $enabledEnum -Profile $r.Profile -ea SilentlyContinue } catch {} }"
        },
        "EnableLLTDIORspndr": {
          "Action": "netbind",
          "ComponentID": [
            "ms_lltdio",
            "ms_rspndr"
          ],
          "State": "enable"
        }
      }
    }
  },
  "Disable WiFi": {
    "apply": {
      "COMMANDS": {
        "DisableWiFiTasks": {
          "Action": "scheduled_task",
          "TaskNames": [
            "\\Microsoft\\Windows\\WCM\\WiFiTask",
            "\\Microsoft\\Windows\\WlanSvc\\CDSSync",
            "\\Microsoft\\Windows\\WwanSvc\\NotificationTask",
            "\\Microsoft\\Windows\\WwanSvc\\OobeDiscovery",
            "\\Microsoft\\Windows\\WlanSvc\\MoProfileManagement"
          ],
          "TaskAction": "disable"
        },
        "DisableWlanSvc": {
          "Action": "reg_add",
          "RegistryPath": "HKLM\\SYSTEM\\CurrentControlSet\\Services\\WlanSvc",
          "ValueName": "Start",
          "ValueType": "REG_DWORD",
          "Data": "4"
        },
        "DisableVwififlt": {
          "Action": "reg_add",
          "RegistryPath": "HKLM\\SYSTEM\\CurrentControlSet\\Services\\vwififlt",
          "ValueName": "Start",
          "ValueType": "REG_DWORD",
          "Data": "4"
        }
      }
    },
    "revert": {
      "COMMANDS": {
        "EnableWiFiTasks": {
          "Action": "scheduled_task",
          "TaskNames": [
            "\\Microsoft\\Windows\\WCM\\WiFiTask",
            "\\Microsoft\\Windows\\WlanSvc\\CDSSync",
            "\\Microsoft\\Windows\\WwanSvc\\NotificationTask",
            "\\Microsoft\\Windows\\WwanSvc\\OobeDiscovery",
            "\\Microsoft\\Windows\\WlanSvc\\MoProfileManagement"
          ],
          "TaskAction": "enable"
        },
        "EnableWlanSvc": {
          "Action": "reg_add",
          "RegistryPath": "HKLM\\SYSTEM\\CurrentControlSet\\Services\\WlanSvc",
          "ValueName": "Start",
          "ValueType": "REG_DWORD",
          "Data": "2"
        },
        "EnableVwififlt": {
          "Action": "reg_add",
          "RegistryPath": "HKLM\\SYSTEM\\CurrentControlSet\\Services\\vwififlt",
          "ValueName": "Start",
          "ValueType": "REG_DWORD",
          "Data": "2"
        }
      }
    }
  },
  "Disable Active Probing": {
    "apply": {
      "HKLM\\SYSTEM\\CurrentControlSet\\Services\\NlaSvc\\Parameters\\Internet": {
        "EnableActiveProbing": { "Type": "REG_DWORD", "Data": 0 }
      },
      "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\NetworkConnectivityStatusIndicator": {
        "NoActiveProbe": { "Type": "REG_DWORD", "Data": 1 }
      }
    },
    "revert": {
      "HKLM\\SYSTEM\\CurrentControlSet\\Services\\NlaSvc\\Parameters\\Internet": {
        "EnableActiveProbing": { "Type": "REG_DWORD", "Data": 1 }
      },
      "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\NetworkConnectivityStatusIndicator": {
        "NoActiveProbe": { "Action": "deletevalue" }
      }
    }
  },
  "Disable VPNs": {
    "apply": {
      "HKLM\\SYSTEM\\CurrentControlSet\\Services\\RasMan": {
        "Start": { "Type": "REG_DWORD", "Data": 4 }
      },
      "HKLM\\SYSTEM\\CurrentControlSet\\Services\\SstpSvc": {
        "Start": { "Type": "REG_DWORD", "Data": 4 }
      },
      "HKLM\\SOFTWARE\\Microsoft\\PolicyManager\\default\\Connectivity\\AllowVPNOverCellular": {
        "value": { "Type": "REG_DWORD", "Data": 0 }
      },
      "HKLM\\SOFTWARE\\Microsoft\\PolicyManager\\default\\Connectivity\\AllowVPNRoamingOverCellular": {
        "value": { "Type": "REG_DWORD", "Data": 0 }
      }
    },
    "revert": {
      "HKLM\\SYSTEM\\CurrentControlSet\\Services\\RasMan": {
        "Start": { "Type": "REG_DWORD", "Data": 3 }
      },
      "HKLM\\SYSTEM\\CurrentControlSet\\Services\\SstpSvc": {
        "Start": { "Type": "REG_DWORD", "Data": 3 }
      },
      "HKLM\\SOFTWARE\\Microsoft\\PolicyManager\\default\\Connectivity\\AllowVPNOverCellular": {
        "value": { "Type": "REG_DWORD", "Data": 1 }
      },
      "HKLM\\SOFTWARE\\Microsoft\\PolicyManager\\default\\Connectivity\\AllowVPNRoamingOverCellular": {
        "value": { "Type": "REG_DWORD", "Data": 1 }
      }
    }
  },
  "Disable SMBv1/SMBv2": {
    "apply": {
      "COMMANDS": {
        "DisableSMBRegistry": {
          "Action": "registry_pattern",
          "Root": "HKLM",
          "Pattern": "SYSTEM\\CurrentControlSet\\Services\\LanmanServer\\Parameters",
          "Operations": [
            { "Name": "SMB1", "Type": "REG_DWORD", "Value": 0 },
            { "Name": "SMB2", "Type": "REG_DWORD", "Value": 0 }
          ]
        },
        "DisableSMB1Feature": {
          "Action": "optional_feature",
          "FeatureName": "SMB1Protocol",
          "State": "Disabled"
        }
      }
    },
    "revert": {
      "COMMANDS": {
        "DeleteSMBRegistry": {
          "Action": "registry_pattern",
          "Root": "HKLM",
          "Pattern": "SYSTEM\\CurrentControlSet\\Services\\LanmanServer\\Parameters",
          "Operations": [
            { "Name": "SMB1", "Operation": "Delete" },
            { "Name": "SMB2", "Operation": "Delete" }
          ]
        },
        "DisableSMB1FeatureAgain": {
          "Action": "optional_feature",
          "FeatureName": "SMB1Protocol",
          "State": "Disabled"
        }
      }
    }
  },
  "Disable NetBIOS/mDNS/LLMNR": {
    "apply": {
      "HKLM\\SYSTEM\\CurrentControlSet\\Services\\Dnscache\\Parameters": {
        "EnableMDNS": { "Type": "REG_DWORD", "Data": 0 },
        "EnableNetbios": { "Type": "REG_DWORD", "Data": 0 },
        "EnableMulticast": { "Type": "REG_DWORD", "Data": 0 },
        "DisableSmartNameResolution": { "Type": "REG_DWORD", "Data": 1 }
      },
      "COMMANDS": {
        "DisableNetBIOSOptions": {
          "Action": "registry_pattern",
          "Root": "HKLM",
          "Pattern": "SYSTEM\\CurrentControlSet\\Services\\NetBT\\Parameters\\Interfaces",
          "Operations": [
            { "Name": "NetbiosOptions", "Type": "REG_DWORD", "Value": 2 }
          ]
        }
      }
    },
    "revert": {
      "HKLM\\SYSTEM\\CurrentControlSet\\Services\\Dnscache\\Parameters": {
        "EnableMDNS": { "Action": "deletevalue" },
        "EnableNetbios": { "Action": "deletevalue" },
        "EnableMulticast": { "Action": "deletevalue" },
        "DisableSmartNameResolution": { "Action": "deletevalue" }
      },
      "COMMANDS": {
        "EnableNetBIOSOptions": {
          "Action": "registry_pattern",
          "Root": "HKLM",
          "Pattern": "SYSTEM\\CurrentControlSet\\Services\\NetBT\\Parameters\\Interfaces",
          "Operations": [
            { "Name": "NetbiosOptions", "Type": "REG_DWORD", "Value": 0 }
          ]
        }
      }
    }
  },
  "Disable Power Management": {
    "apply": {
      "HKLM\\Software\\Policies\\Microsoft\\Windows\\WcmSvc\\GroupPolicy": {
        "fDisablePowerManagement": { "Type": "REG_DWORD", "Data": 1 }
      },
      "HKLM\\Software\\Policies\\Microsoft\\Windows\\WcmSvc\\Local": {
        "fDisablePowerManagement": { "Type": "REG_DWORD", "Data": 1 }
      }
    },
    "revert": {
      "HKLM\\Software\\Policies\\Microsoft\\Windows\\WcmSvc\\GroupPolicy": {
        "fDisablePowerManagement": { "Action": "deletevalue" }
      },
      "HKLM\\Software\\Policies\\Microsoft\\Windows\\WcmSvc\\Local": {
        "fDisablePowerManagement": { "Action": "deletevalue" }
      }
    }
  }
}
